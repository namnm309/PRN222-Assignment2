@page "/EVMStaff/Dashboard"
@model PresentationLayer.Pages.EVMStaff.Dashboard.IndexModel
@{
    Layout = "~/Pages/Shared/_DashboardLayout.cshtml";
    ViewData["Title"] = "EVM Staff Dashboard";
}

<!-- Welcome Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="mb-1">
            <i class="fas fa-tachometer-alt me-2 text-primary"></i>
            Chào mừng, @Model.CurrentUserName
        </h2>
        <p class="text-muted mb-0">
            <i class="fas fa-shield-alt me-1"></i> EVM Staff Dashboard - Tổng quan hệ thống
        </p>
    </div>
    <div>
        <span class="badge bg-success px-3 py-2">
            <i class="fas fa-clock me-1"></i> @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
        </span>
    </div>
</div>

<!-- Alert Messages -->
@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle me-2"></i>@TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}
@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle me-2"></i>@TempData["Error"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<!-- Statistics Cards -->
<div class="row g-4 mb-4">
    <!-- Total Products -->
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                        <div class="stat-icon bg-primary bg-opacity-10 text-primary rounded-circle d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="fas fa-car fa-2x"></i>
                        </div>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h6 class="text-muted mb-1 small">Tổng sản phẩm</h6>
                        <h3 class="mb-0 fw-bold">@Model.TotalProducts</h3>
                        <small class="text-success">
                            <i class="fas fa-arrow-up"></i> Đang kinh doanh
                        </small>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a asp-page="/EVMStaff/ProductManagement/Index" class="btn btn-sm btn-outline-primary w-100">
                    <i class="fas fa-eye me-1"></i> Xem chi tiết
                </a>
            </div>
        </div>
    </div>

    <!-- Total Dealers -->
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                        <div class="stat-icon bg-success bg-opacity-10 text-success rounded-circle d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="fas fa-building fa-2x"></i>
                        </div>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h6 class="text-muted mb-1 small">Tổng đại lý</h6>
                        <h3 class="mb-0 fw-bold">@Model.TotalDealers</h3>
                        <small class="text-muted">
                            <i class="fas fa-check-circle"></i> Đang hoạt động
                        </small>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a asp-page="/EVMStaff/DealerManagement/Index" class="btn btn-sm btn-outline-success w-100">
                    <i class="fas fa-eye me-1"></i> Xem chi tiết
                </a>
            </div>
        </div>
    </div>

    <!-- Total Orders -->
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                        <div class="stat-icon bg-info bg-opacity-10 text-info rounded-circle d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="fas fa-shopping-cart fa-2x"></i>
                        </div>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h6 class="text-muted mb-1 small">Tổng đơn hàng</h6>
                        <h3 class="mb-0 fw-bold">@Model.TotalOrders</h3>
                        <small class="text-info">
                            <i class="fas fa-chart-line"></i> Tất cả thời gian
                        </small>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a asp-page="/EVMStaff/SalesReport/Index" class="btn btn-sm btn-outline-info w-100">
                    <i class="fas fa-eye me-1"></i> Xem chi tiết
                </a>
            </div>
        </div>
    </div>

    <!-- Pending Purchase Orders -->
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-shrink-0">
                        <div class="stat-icon bg-warning bg-opacity-10 text-warning rounded-circle d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                            <i class="fas fa-clock fa-2x"></i>
                        </div>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h6 class="text-muted mb-1 small">Đơn chờ duyệt</h6>
                        <h3 class="mb-0 fw-bold">@Model.PendingPurchaseOrders</h3>
                        <small class="text-warning">
                            <i class="fas fa-exclamation-circle"></i> Cần xử lý
                        </small>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a asp-page="/EVMStaff/PurchaseOrderManagement/Index" class="btn btn-sm btn-outline-warning w-100">
                    <i class="fas fa-eye me-1"></i> Xem chi tiết
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Revenue & Low Stock -->
<div class="row g-4 mb-4">
    <!-- Total Revenue -->
    <div class="col-12 col-lg-6">
        <div class="card border-0 shadow-sm h-100">
            <div class="card-header bg-transparent border-0 pt-3">
                <h5 class="mb-0">
                    <i class="fas fa-dollar-sign me-2 text-success"></i>
                    Doanh thu tổng
                </h5>
            </div>
            <div class="card-body">
                <h2 class="display-4 fw-bold text-success mb-0">
                    @Model.TotalRevenue.ToString("N0") VNĐ
                </h2>
                <p class="text-muted mb-0">Tổng doanh thu từ tất cả đơn hàng</p>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a asp-page="/EVMStaff/SalesReport/ByRegion" class="btn btn-outline-success w-100">
                    <i class="fas fa-chart-bar me-2"></i> Xem báo cáo chi tiết
                </a>
            </div>
        </div>
    </div>

    <!-- Low Stock Alert -->
    <div class="col-12 col-lg-6">
        <div class="card border-0 shadow-sm h-100 @(Model.LowStockProducts > 0 ? "border-danger" : "")">
            <div class="card-header bg-transparent border-0 pt-3">
                <h5 class="mb-0">
                    <i class="fas fa-exclamation-triangle me-2 text-danger"></i>
                    Cảnh báo tồn kho
                </h5>
            </div>
            <div class="card-body">
                <h2 class="display-4 fw-bold text-danger mb-0">
                    @Model.LowStockProducts
                </h2>
                <p class="text-muted mb-0">Sản phẩm có tồn kho ≤ 10 chiếc</p>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a asp-page="/EVMStaff/InventoryManagement/Index" class="btn btn-outline-danger w-100">
                    <i class="fas fa-warehouse me-2"></i> Quản lý tồn kho
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row g-4">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">
                    <i class="fas fa-bolt me-2"></i>
                    Thao tác nhanh
                </h5>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-12 col-md-6 col-lg-3">
                        <a asp-page="/EVMStaff/ProductManagement/Create" class="btn btn-outline-primary w-100 py-3">
                            <i class="fas fa-plus-circle fa-2x mb-2 d-block"></i>
                            <strong>Thêm sản phẩm mới</strong>
                        </a>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3">
                        <a asp-page="/EVMStaff/InventoryManagement/Allocate" class="btn btn-outline-success w-100 py-3">
                            <i class="fas fa-truck fa-2x mb-2 d-block"></i>
                            <strong>Điều phối tồn kho</strong>
                        </a>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3">
                        <a asp-page="/EVMStaff/PricingManagement/Index" class="btn btn-outline-info w-100 py-3">
                            <i class="fas fa-tags fa-2x mb-2 d-block"></i>
                            <strong>Quản lý giá</strong>
                        </a>
                    </div>
                    <div class="col-12 col-md-6 col-lg-3">
                        <a asp-page="/EVMStaff/UserManagement/Index" class="btn btn-outline-warning w-100 py-3">
                            <i class="fas fa-users-cog fa-2x mb-2 d-block"></i>
                            <strong>Quản lý tài khoản</strong>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Auto refresh statistics every 5 minutes
        setTimeout(function() {
            location.reload();
        }, 300000);
    </script>
}

