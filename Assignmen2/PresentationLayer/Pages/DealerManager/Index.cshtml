@page
@model PresentationLayer.Pages.DealerManager.IndexModel
@{
	Layout = "/Pages/Shared/_DashboardLayout.cshtml";
	ViewData["Title"] = "Dealer Manager Dashboard";
}

<div class="container-fluid">
	<!-- Header Section -->
	<div class="row mb-4">
		<div class="col-12">
			<div class="card border-0 shadow-sm" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
				<div class="card-body text-white p-4">
					<div class="d-flex align-items-center justify-content-between">
						<div>
							<h2 class="mb-2 fw-bold">@Model.DealerName</h2>
							<p class="mb-0 opacity-75 vn-date"><i class="fas fa-calendar-alt me-2"></i>@DateTime.Now.ToString("dddd, dd/MM/yyyy", new System.Globalization.CultureInfo("vi-VN"))</p>
						</div>
						<div class="text-end">
							<div class="fs-5 fw-semibold">Dashboard</div>
							<div class="small opacity-75">Tổng quan hoạt động đại lý</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- KPI Cards -->
	<div class="row g-3 mb-4">
		<div class="col-xl-3 col-md-6">
			@{
				ViewData["Title"] = "Doanh thu tháng";
				ViewData["Value"] = Model.MonthlyRevenue.ToString("N0", new System.Globalization.CultureInfo("vi-VN"));
				ViewData["Unit"] = "VND";
				ViewData["IconClass"] = "fas fa-chart-line";
				ViewData["GradientClass"] = "linear-gradient(135deg, #667eea 0%, #764ba2 100%)";
				ViewData["ProgressPercent"] = 75;
				ViewData["SubText"] = "<i class=\"fas fa-arrow-up me-1\"></i>12% so với tháng trước";
			}
			<partial name="_KpiCard" />
		</div>

		<div class="col-xl-3 col-md-6">
			@{
				ViewData["Title"] = "Lái thử tháng";
				ViewData["Value"] = Model.MonthlyTestDrives.ToString();
				ViewData["Unit"] = "Lịch hẹn";
				ViewData["IconClass"] = "fas fa-calendar-check";
				ViewData["GradientClass"] = "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)";
				ViewData["ProgressPercent"] = 45;
				ViewData["SubText"] = "<i class=\"fas fa-info-circle me-1\"></i>Lịch đang chờ xử lý";
			}
			<partial name="_KpiCard" />
		</div>

		<div class="col-xl-3 col-md-6">
			@{
				ViewData["Title"] = "Khách hàng mới";
				ViewData["Value"] = Model.NewCustomers.ToString();
				ViewData["Unit"] = "Khách hàng";
				ViewData["IconClass"] = "fas fa-users";
				ViewData["GradientClass"] = "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)";
				ViewData["ProgressPercent"] = 88;
				ViewData["SubText"] = "<i class=\"fas fa-user-plus me-1\"></i>Tháng này";
			}
			<partial name="_KpiCard" />
		</div>

		<div class="col-xl-3 col-md-6">
			@{
				ViewData["Title"] = "Đơn hàng tháng";
				ViewData["Value"] = Model.MonthlyOrders.ToString();
				ViewData["Unit"] = "Đơn hàng";
				ViewData["IconClass"] = "fas fa-shopping-cart";
				ViewData["GradientClass"] = "linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)";
				ViewData["ProgressPercent"] = 92;
				ViewData["SubText"] = "<i class=\"fas fa-check-circle me-1\"></i>Đã hoàn thành 70%";
			}
			<partial name="_KpiCard" />
		</div>
	</div>

	<!-- Quick Actions -->
	<div class="row g-3 mb-4">
		<div class="col-md-3">
			<a asp-page="/DealerManager/Orders/Create" class="text-decoration-none">
				<div class="card border-0 shadow-sm h-100 hover-lift">
					<div class="card-body text-center p-4">
						<div class="mb-3">
							<div class="p-3 rounded-circle d-inline-block" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
								<i class="fas fa-file-invoice-dollar fs-2 text-white"></i>
							</div>
						</div>
						<h5 class="mb-2 fw-semibold">Tạo báo giá</h5>
						<p class="text-muted small mb-0">Tạo báo giá nhanh chóng</p>
					</div>
				</div>
			</a>
		</div>
		<div class="col-md-3">
			<a asp-page="/DealerManager/PurchaseOrders/Create" class="text-decoration-none">
				<div class="card border-0 shadow-sm h-100 hover-lift">
					<div class="card-body text-center p-4">
						<div class="mb-3">
							<div class="p-3 rounded-circle d-inline-block" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
								<i class="fas fa-box fs-2 text-white"></i>
							</div>
						</div>
						<h5 class="mb-2 fw-semibold">Đặt xe từ hãng</h5>
						<p class="text-muted small mb-0">Tạo đơn đặt hàng mới</p>
					</div>
				</div>
			</a>
		</div>
		<div class="col-md-3">
			<a asp-page="/DealerManager/Customers/Create" class="text-decoration-none">
				<div class="card border-0 shadow-sm h-100 hover-lift">
					<div class="card-body text-center p-4">
						<div class="mb-3">
							<div class="p-3 rounded-circle d-inline-block" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
								<i class="fas fa-user-plus fs-2 text-white"></i>
							</div>
						</div>
						<h5 class="mb-2 fw-semibold">Thêm khách hàng</h5>
						<p class="text-muted small mb-0">Đăng ký khách hàng mới</p>
					</div>
				</div>
			</a>
		</div>
		<div class="col-md-3">
			<a asp-page="/DealerManager/Vehicles/Search" class="text-decoration-none">
				<div class="card border-0 shadow-sm h-100 hover-lift">
					<div class="card-body text-center p-4">
						<div class="mb-3">
							<div class="p-3 rounded-circle d-inline-block" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
								<i class="fas fa-search fs-2 text-white"></i>
							</div>
						</div>
						<h5 class="mb-2 fw-semibold">Tra cứu xe</h5>
						<p class="text-muted small mb-0">Tìm kiếm sản phẩm</p>
					</div>
				</div>
			</a>
		</div>
	</div>

	<!-- Recent Activities & Stats -->
	<div class="row g-3">
		<div class="col-lg-8">
			<div class="card border-0 shadow-sm">
				<div class="card-header bg-white border-0 py-3">
					<h5 class="mb-0"><i class="fas fa-chart-bar me-2 text-primary"></i>Hoạt động gần đây</h5>
				</div>
				<div class="card-body p-0">
					<div class="list-group list-group-flush">
						@{
							ViewData["IconClass"] = "fas fa-file-invoice";
							ViewData["Title"] = "Báo giá mới được tạo";
							ViewData["Description"] = "Báo giá #BG001 cho khách hàng Nguyễn Văn A";
							ViewData["TimeAgo"] = "5 phút trước";
							ViewData["ColorClass"] = "bg-primary";
						}
						<partial name="_ActivityItem" />
						
						@{
							ViewData["IconClass"] = "fas fa-calendar-check";
							ViewData["Title"] = "Lịch lái thử được xác nhận";
							ViewData["Description"] = "VinFast VF e34 - Khách hàng Trần Thị B";
							ViewData["TimeAgo"] = "1 giờ trước";
							ViewData["ColorClass"] = "bg-success";
						}
						<partial name="_ActivityItem" />
						
						@{
							ViewData["IconClass"] = "fas fa-user-plus";
							ViewData["Title"] = "Khách hàng mới";
							ViewData["Description"] = "Lê Văn C đã được thêm vào hệ thống";
							ViewData["TimeAgo"] = "3 giờ trước";
							ViewData["ColorClass"] = "bg-info";
						}
						<partial name="_ActivityItem" />
						
						@{
							ViewData["IconClass"] = "fas fa-box";
							ViewData["Title"] = "Đơn đặt hàng mới";
							ViewData["Description"] = "Đặt 5 xe VinFast VF 8 từ nhà máy";
							ViewData["TimeAgo"] = "1 ngày trước";
							ViewData["ColorClass"] = "bg-warning";
						}
						<partial name="_ActivityItem" />
					</div>
				</div>
				<div class="card-footer bg-white border-0 text-center py-3">
					<a asp-page="/DealerManager/Reports/Index" class="text-decoration-none small">Xem tất cả <i class="fas fa-arrow-right ms-1"></i></a>
				</div>
			</div>
		</div>

		<div class="col-lg-4">
			<div class="card border-0 shadow-sm mb-3">
				<div class="card-header bg-white border-0 py-3">
					<h5 class="mb-0"><i class="fas fa-tasks me-2 text-warning"></i>Cần xử lý</h5>
				</div>
				<div class="card-body">
					<a asp-page="/DealerManager/TestDrives/Index" class="text-decoration-none">
						<div class="d-flex align-items-center justify-content-between mb-3 pb-3 border-bottom hover-bg-light p-2 rounded">
							<div class="d-flex align-items-center">
								<div class="bg-warning bg-opacity-10 p-2 rounded me-3">
									<i class="fas fa-exclamation-circle text-warning fs-5"></i>
								</div>
								<div>
									<div class="fw-semibold">Lịch lái thử</div>
									<small class="text-muted">Chờ xác nhận</small>
								</div>
							</div>
							@{
								ViewData["status"] = Model.MonthlyTestDrives.ToString();
							}
							<span class="badge bg-warning">@Model.MonthlyTestDrives</span>
						</div>
					</a>
					<a asp-page="/DealerManager/Orders/Index" class="text-decoration-none">
						<div class="d-flex align-items-center justify-content-between hover-bg-light p-2 rounded">
							<div class="d-flex align-items-center">
								<div class="bg-info bg-opacity-10 p-2 rounded me-3">
									<i class="fas fa-shopping-cart text-info fs-5"></i>
								</div>
								<div>
									<div class="fw-semibold">Đơn hàng mới</div>
									<small class="text-muted">Chưa xử lý</small>
								</div>
							</div>
							@{
								var pendingOrders = (int)(Model.MonthlyOrders * 0.15);
							}
							<span class="badge bg-info">@pendingOrders</span>
						</div>
					</a>
				</div>
			</div>

			<div class="card border-0 shadow-sm">
				<div class="card-header bg-white border-0 py-3">
					<h5 class="mb-0"><i class="fas fa-star me-2 text-success"></i>Thống kê tuần</h5>
				</div>
				<div class="card-body">
					<div class="mb-3">
						<div class="d-flex justify-content-between mb-2">
							<small class="fw-semibold">Doanh số</small>
							<small class="fw-semibold text-success vn-currency">75%</small>
						</div>
						<div class="progress" style="height: 8px; border-radius: 4px;">
							<div class="progress-bar" style="width: 75%; background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%); border-radius: 4px;"></div>
						</div>
					</div>
					<div class="mb-3">
						<div class="d-flex justify-content-between mb-2">
							<small class="fw-semibold">Khách hàng mới</small>
							<small class="fw-semibold text-info vn-currency">60%</small>
						</div>
						<div class="progress" style="height: 8px; border-radius: 4px;">
							<div class="progress-bar" style="width: 60%; background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%); border-radius: 4px;"></div>
						</div>
					</div>
					<div>
						<div class="d-flex justify-content-between mb-2">
							<small class="fw-semibold">Hoàn thành đơn</small>
							<small class="fw-semibold text-primary vn-currency">88%</small>
						</div>
						<div class="progress" style="height: 8px; border-radius: 4px;">
							<div class="progress-bar" style="width: 88%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); border-radius: 4px;"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<style>
	.avatar-circle {
		width: 45px;
		height: 45px;
		border-radius: 50%;
		display: flex;
		align-items-center;
		justify-content: center;
		font-weight: 600;
	}
	
	.hover-lift {
		transition: transform 0.2s ease, box-shadow 0.2s ease;
	}
	
	.hover-lift:hover {
		transform: translateY(-5px);
		box-shadow: 0 0.5rem 1.5rem rgba(0,0,0,0.15) !important;
	}

	.hover-bg-light {
		transition: background-color 0.2s ease;
	}

	.hover-bg-light:hover {
		background-color: rgba(0,0,0,0.02);
	}
</style>
