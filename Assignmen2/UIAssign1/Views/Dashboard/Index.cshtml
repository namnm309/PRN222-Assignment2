@using BusinessLayer.Enums
@{
    ViewData["Title"] = "Dashboard";
    Layout = "_DashboardLayout";
    var userRole = ViewBag.UserRole as UserRole?;
    
    string dashboardTitle = userRole switch
    {
        UserRole.DealerStaff => "Dashboard Nh√¢n Vi√™n ƒê·∫°i L√Ω",
        UserRole.DealerManager => "Dashboard Qu·∫£n L√Ω ƒê·∫°i L√Ω",
        UserRole.EVMStaff => "Dashboard Nh√¢n Vi√™n EVM",
        UserRole.Admin => "Dashboard Qu·∫£n Tr·ªã Vi√™n",
        _ => "Dashboard"
    };
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="mb-1">@dashboardTitle</h2>
        <p class="text-muted mb-0">T·ªïng quan ho·∫°t ƒë·ªông v√† s·ªë li·ªáu th·ªëng k√™</p>
    </div>
    <div>
        <span class="text-muted">@DateTime.Now.ToString("dd/MM/yyyy HH:mm")</span>
    </div>
</div>


@if (userRole == UserRole.DealerStaff)
{
    <!-- Dashboard cho Dealer Staff -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">ƒê∆°n h√†ng th√°ng n√†y</p>
                            <h3 class="mb-0">45</h3>
                        </div>
                        <div class="fs-1 text-primary">üì¶</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+12%</span>
                        <small class="text-muted ms-1">so v·ªõi th√°ng tr∆∞·ªõc</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Doanh thu th√°ng</p>
                            <h3 class="mb-0">5.2 t·ª∑</h3>
                        </div>
                        <div class="fs-1 text-success">üí∞</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+8%</span>
                        <small class="text-muted ms-1">so v·ªõi th√°ng tr∆∞·ªõc</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">L·ªãch l√°i th·ª≠</p>
                            <h3 class="mb-0">12</h3>
                        </div>
                        <div class="fs-1 text-warning">üöó</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-info">Tu·∫ßn n√†y</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Kh√°ch h√†ng m·ªõi</p>
                            <h3 class="mb-0">28</h3>
                        </div>
                        <div class="fs-1 text-info">üë•</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-primary">Th√°ng n√†y</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-12 col-lg-8">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0">Doanh s·ªë 7 ng√†y g·∫ßn nh·∫•t</h5>
                </div>
                <div class="card-body">
                    <div class="text-center text-muted py-5">
                        <p>üìä Bi·ªÉu ƒë·ªì doanh s·ªë s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫°i ƒë√¢y</p>
                        <small>(T√≠ch h·ª£p Chart.js ho·∫∑c ApexCharts)</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-lg-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <div class="list-group-item px-0">
                            <div class="d-flex align-items-start">
                                <span class="badge bg-success me-2">‚úì</span>
                                <div class="flex-grow-1">
                                    <p class="mb-0 small">ƒê∆°n h√†ng #DH-001 ƒë√£ ho√†n th√†nh</p>
                                    <small class="text-muted">5 ph√∫t tr∆∞·ªõc</small>
                                </div>
                            </div>
                        </div>
                        <div class="list-group-item px-0">
                            <div class="d-flex align-items-start">
                                <span class="badge bg-primary me-2">üìÖ</span>
                                <div class="flex-grow-1">
                                    <p class="mb-0 small">L·ªãch l√°i th·ª≠ VF 8 - Nguy·ªÖn VƒÉn A</p>
                                    <small class="text-muted">2 gi·ªù tr∆∞·ªõc</small>
                                </div>
                            </div>
                        </div>
                        <div class="list-group-item px-0">
                            <div class="d-flex align-items-start">
                                <span class="badge bg-warning me-2">‚è≥</span>
                                <div class="flex-grow-1">
                                    <p class="mb-0 small">ƒê∆°n h√†ng #DH-002 ch·ªù x√°c nh·∫≠n</p>
                                    <small class="text-muted">3 gi·ªù tr∆∞·ªõc</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else if (userRole == UserRole.DealerManager)
{
    <!-- Dashboard cho Dealer Manager -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Doanh s·ªë ƒë·∫°i l√Ω</p>
                            <h3 class="mb-0">125 t·ª∑</h3>
                        </div>
                        <div class="fs-1 text-success">üí∞</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+15%</span>
                        <small class="text-muted ms-1">so v·ªõi th√°ng tr∆∞·ªõc</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Nh√¢n vi√™n</p>
                            <h3 class="mb-0">24</h3>
                        </div>
                        <div class="fs-1 text-primary">üë•</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-info">Ho·∫°t ƒë·ªông</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">ƒê∆°n h√†ng th√°ng</p>
                            <h3 class="mb-0">156</h3>
                        </div>
                        <div class="fs-1 text-warning">üì¶</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+22%</span>
                        <small class="text-muted ms-1">tƒÉng tr∆∞·ªüng</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Kh√°ch h√†ng</p>
                            <h3 class="mb-0">892</h3>
                        </div>
                        <div class="fs-1 text-info">üë§</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-primary">T·ªïng s·ªë</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else if (userRole == UserRole.EVMStaff)
{
    <!-- Dashboard cho EVM Staff -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">S·∫£n ph·∫©m</p>
                            <h3 class="mb-0">48</h3>
                        </div>
                        <div class="fs-1 text-primary">üöó</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-info">ƒêang qu·∫£n l√Ω</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">T·ªìn kho</p>
                            <h3 class="mb-0">1,245</h3>
                        </div>
                        <div class="fs-1 text-warning">üì¶</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-warning">To√†n h·ªá th·ªëng</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">ƒê·∫°i l√Ω</p>
                            <h3 class="mb-0">28</h3>
                        </div>
                        <div class="fs-1 text-info">üè¢</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">Ho·∫°t ƒë·ªông</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Doanh s·ªë th√°ng</p>
                            <h3 class="mb-0">85 t·ª∑</h3>
                        </div>
                        <div class="fs-1 text-success">üí∞</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+18%</span>
                        <small class="text-muted ms-1">tƒÉng</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
else if (userRole == UserRole.Admin)
{
    <!-- Dashboard cho Admin - Full Overview -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">T·ªïng ƒë·∫°i l√Ω</p>
                            <h3 class="mb-0">48</h3>
                        </div>
                        <div class="fs-1 text-primary">üè¢</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+3 m·ªõi</span>
                        <small class="text-muted ms-1">trong qu√Ω</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">Doanh s·ªë to√†n qu·ªëc</p>
                            <h3 class="mb-0">125 t·ª∑</h3>
                        </div>
                        <div class="fs-1 text-success">üìà</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-success">+15%</span>
                        <small class="text-muted ms-1">so v·ªõi th√°ng tr∆∞·ªõc</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">T·ªìn kho xe</p>
                            <h3 class="mb-0">1,245</h3>
                        </div>
                        <div class="fs-1 text-warning">üöó</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-warning">To√†n h·ªá th·ªëng</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <p class="text-muted mb-1 small">S·∫£n ph·∫©m</p>
                            <h3 class="mb-0">24</h3>
                        </div>
                        <div class="fs-1 text-info">üì¶</div>
                    </div>
                    <div class="mt-2">
                        <span class="badge bg-info">D√≤ng xe</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-12 col-lg-8">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0">Doanh s·ªë theo khu v·ª±c</h5>
                </div>
                <div class="card-body">
                    <div class="text-center text-muted py-5">
                        <p>üó∫Ô∏è Bi·ªÉu ƒë·ªì doanh s·ªë theo khu v·ª±c s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y</p>
                        <small>(Map chart ho·∫∑c Bar chart theo mi·ªÅn)</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12 col-lg-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0">Top ƒë·∫°i l√Ω th√°ng n√†y</h5>
                </div>
                <div class="card-body">
                    <div class="list-group list-group-flush">
                        <div class="list-group-item px-0 d-flex justify-content-between">
                            <div>
                                <span class="badge bg-warning me-2">ü•á</span>
                                <strong>VinFast H√† N·ªôi</strong>
                            </div>
                            <span class="text-primary fw-bold">12.5 t·ª∑</span>
                        </div>
                        <div class="list-group-item px-0 d-flex justify-content-between">
                            <div>
                                <span class="badge bg-secondary me-2">ü•à</span>
                                <strong>VinFast TP.HCM</strong>
                            </div>
                            <span class="text-primary fw-bold">10.2 t·ª∑</span>
                        </div>
                        <div class="list-group-item px-0 d-flex justify-content-between">
                            <div>
                                <span class="badge bg-danger me-2">ü•â</span>
                                <strong>VinFast ƒê√† N·∫µng</strong>
                            </div>
                            <span class="text-primary fw-bold">8.7 t·ª∑</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

    <div class="row g-3 mt-3">
    <div class="col-12">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white">
                <h5 class="mb-0">Th√¥ng b√°o h·ªá th·ªëng</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info mb-0">
                    <strong>‚ÑπÔ∏è Th√¥ng b√°o:</strong> Trang Dashboard ƒëang trong giai ƒëo·∫°n ph√°t tri·ªÉn. C√°c bi·ªÉu ƒë·ªì v√† d·ªØ li·ªáu th·ª±c s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t sau.
                </div>
            </div>
        </div>
    </div>
</div>

@if (userRole == UserRole.Admin || userRole == UserRole.EVMStaff)
{
    <div class="row g-3 mt-3">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0">EVM Dashboard</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-12 col-md-6">
                            <div class="d-flex align-items-center p-3 bg-light rounded">
                                <div class="me-3">
                                    <i class="fas fa-chart-line fa-2x text-primary"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">B√°o c√°o doanh s·ªë</h6>
                                    <p class="text-muted mb-0 small">Ph√¢n t√≠ch doanh s·ªë theo khu v·ª±c v√† ƒë·∫°i l√Ω</p>
                                </div>
                                <div>
                                    <a asp-controller="EVMDashboard" asp-action="SalesReport" class="btn btn-outline-primary btn-sm">Xem</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex align-items-center p-3 bg-light rounded">
                                <div class="me-3">
                                    <i class="fas fa-boxes fa-2x text-warning"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">Qu·∫£n l√Ω t·ªìn kho</h6>
                                    <p class="text-muted mb-0 small">Gi√°m s√°t t·ªìn kho v√† t·ªëc ƒë·ªô ti√™u th·ª•</p>
                                </div>
                                <div>
                                    <a asp-controller="EVMDashboard" asp-action="InventoryReport" class="btn btn-outline-warning btn-sm">Xem</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex align-items-center p-3 bg-light rounded">
                                <div class="me-3">
                                    <i class="fas fa-brain fa-2x text-info"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">AI d·ª± ƒëo√°n nhu c·∫ßu</h6>
                                    <p class="text-muted mb-0 small">D·ª± b√°o nhu c·∫ßu ƒë·ªÉ l·∫≠p k·∫ø ho·∫°ch s·∫£n xu·∫•t</p>
                                </div>
                                <div>
                                    <a asp-controller="EVMDashboard" asp-action="DemandForecast" class="btn btn-outline-info btn-sm">Xem</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-md-6">
                            <div class="d-flex align-items-center p-3 bg-light rounded">
                                <div class="me-3">
                                    <i class="fas fa-file-contract fa-2x text-danger"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <h6 class="mb-1">Qu·∫£n l√Ω h·ª£p ƒë·ªìng</h6>
                                    <p class="text-muted mb-0 small">Qu·∫£n l√Ω h·ª£p ƒë·ªìng, ch·ªâ ti√™u v√† c√¥ng n·ª£</p>
                                </div>
                                <div>
                                    <a asp-controller="EVMDashboard" asp-action="ContractManagement" class="btn btn-outline-danger btn-sm">Xem</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    @* <div class="text-center mt-3">
                        <a asp-controller="EVMDashboard" asp-action="Index" class="btn btn-primary">
                            <i class="fas fa-tachometer-alt me-2"></i>M·ªü EVM Dashboard
                        </a>
                    </div> *@
                </div>
            </div>
        </div>
    </div>
}