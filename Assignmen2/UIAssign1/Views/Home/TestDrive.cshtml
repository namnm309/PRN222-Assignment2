@model List<BusinessLayer.ViewModels.HomeProductViewModel>

@{
    ViewData["Title"] = "Đăng ký lái thử";
    Layout = "_Layout";
}

@section FullWidthTop {
    <div class="hero-section-testdrive" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 80px 0; position: relative;">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6" style="color: white; z-index: 2; position: relative;">
                    <h1 class="display-4 fw-bold mb-4" style="color: white;">
                        Đăng ký lái thử <span style="color: #ffc107;">MIỄN PHÍ</span>
                    </h1>
                    <p class="lead mb-4" style="color: white;">
                        Trải nghiệm sức mạnh và sự tiện nghi của xe điện VinFast. Đăng ký lái thử ngay hôm nay để cảm nhận sự khác biệt!
                    </p>
                    <div class="feature-highlights">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-check-circle me-3" style="color: #ffc107;"></i>
                            <span style="color: white;">Lái thử hoàn toàn miễn phí</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-clock me-3" style="color: #ffc107;"></i>
                            <span style="color: white;">Thời gian linh hoạt theo lịch của bạn</span>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-user-tie me-3" style="color: #ffc107;"></i>
                            <span style="color: white;">Có nhân viên tư vấn chuyên nghiệp</span>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-shield-alt me-3" style="color: #ffc107;"></i>
                            <span style="color: white;">An toàn tuyệt đối với bảo hiểm đầy đủ</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="hero-image text-center">
                        <i class="fas fa-car-side" style="font-size: 200px; color: rgba(255,255,255,0.2);"></i>
                    </div>
                </div>
            </div>
        </div>
        <!-- Background pattern overlay -->
        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.1; background: url('data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 100 100\"><defs><pattern id=\"grain\" width=\"100\" height=\"100\" patternUnits=\"userSpaceOnUse\"><circle cx=\"25\" cy=\"25\" r=\"1\" fill=\"white\" opacity=\"0.3\"/><circle cx=\"75\" cy=\"75\" r=\"1\" fill=\"white\" opacity=\"0.3\"/></pattern></defs><rect width=\"100\" height=\"100\" fill=\"url(%23grain)\"/></svg>'); z-index: 1;"></div>
    </div>
}

<div class="py-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold">Chọn xe bạn muốn lái thử</h2>
        <p class="text-muted">Chọn mẫu xe bạn quan tâm để đăng ký lái thử</p>
    </div>

    @if (Model.Count == 0)
    {
        <div class="text-center py-5">
            <i class="fas fa-car fa-3x text-muted mb-3"></i>
            <h4 class="text-muted">Hiện tại chưa có xe nào có sẵn để lái thử</h4>
            <p class="text-muted">Vui lòng quay lại sau hoặc liên hệ với chúng tôi</p>
        </div>
    }
    else
    {
        <div class="row g-4">
            @foreach (var product in Model)
            {
                <div class="col-lg-4 col-md-6">
                    <div class="card h-100 shadow-sm product-card-testdrive">
                        <div class="card-img-wrapper position-relative" style="height: 250px; overflow: hidden;">
                            @if (!string.IsNullOrWhiteSpace(product.ImageUrl))
                            {
                                <img src="@product.ImageUrl" alt="@product.Name" class="card-img-top" style="height: 100%; width: 100%; object-fit: cover; transition: transform 0.3s ease;" />
                            }
                            else
                            {
                                <div class="placeholder-img d-flex align-items-center justify-content-center text-muted" style="height: 100%; background-color: #f8f9fa;">
                                    <div class="text-center">
                                        <i class="fas fa-car fa-3x mb-2"></i>
                                        <div class="small">@product.Name</div>
                                    </div>
                                </div>
                            }
                            <div class="position-absolute bottom-0 start-0 end-0 p-3" style="background: linear-gradient(transparent, rgba(0,0,0,0.7)); pointer-events: none;">
                                <span class="badge bg-primary">@product.BrandName</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title fw-bold">@product.Name</h5>
                            <p class="text-muted small mb-2">SKU: @product.Sku</p>
                            @if (!string.IsNullOrWhiteSpace(product.Description))
                            {
                                <p class="card-text text-muted small">
                                    @(product.Description.Length > 100 ? product.Description.Substring(0, 100) + "..." : product.Description)
                                </p>
                            }
                            <div class="price-info mb-3">
                                <h4 class="text-primary fw-bold mb-0">@product.Price.ToString("N0") VNĐ</h4>
                                <small class="text-muted">Giá niêm yết</small>
                            </div>
                        </div>
                        <div class="card-footer bg-white border-0 p-3 mt-auto">
                            <div class="d-grid gap-2">
                                <a href="@Url.Action("Create", "TestDrive", new { productId = product.Id })" 
                                   class="btn btn-primary fw-semibold py-2" 
                                   style="text-decoration: none; z-index: 10; position: relative;">
                                    <i class="fas fa-calendar-plus me-2"></i>Đăng ký lái thử MIỄN PHÍ
                                </a>
                                <a href="@Url.Action("Detail", "Products", new { id = product.Id })" 
                                   class="btn btn-outline-secondary btn-sm py-1"
                                   style="text-decoration: none; z-index: 10; position: relative;">
                                    <i class="fas fa-info-circle me-1"></i>Xem chi tiết
                                </a>
                            </div>
                            <div class="text-center mt-2">
                                <small class="text-muted">
                                    <i class="fas fa-gift text-success me-1"></i>Hoàn toàn miễn phí
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

@section FullWidthContent {
    <!-- Call to Action Section -->
    <div class="bg-light py-5">
        <div class="container text-center">
            <div class="row justify-content-center">
                <div class="col-lg-8">
                    <h3 class="fw-bold mb-3">Cần hỗ trợ tư vấn?</h3>
                    <p class="text-muted mb-4">Đội ngũ chuyên viên của chúng tôi sẵn sàng hỗ trợ bạn chọn lựa mẫu xe phù hợp nhất</p>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="contact-item">
                                <i class="fas fa-phone-alt text-primary fa-2x mb-3"></i>
                                <h6 class="fw-bold">Hotline</h6>
                                <p class="text-muted mb-0">1900 23 23 89</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="contact-item">
                                <i class="fas fa-envelope text-primary fa-2x mb-3"></i>
                                <h6 class="fw-bold">Email</h6>
                                <p class="text-muted mb-0">support@vinfast.vn</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="contact-item">
                                <i class="fas fa-map-marker-alt text-primary fa-2x mb-3"></i>
                                <h6 class="fw-bold">Showroom</h6>
                                <p class="text-muted mb-0">Toàn quốc</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@section Styles {
    <style>
        .product-card-testdrive {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: none;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .product-card-testdrive:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15) !important;
        }
        
        .product-card-testdrive:hover .card-img-top {
            transform: scale(1.05);
        }
        
        .product-card-testdrive .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-card-testdrive .price-info {
            margin-top: auto;
        }
        
        .contact-item {
            padding: 20px;
        }
        
        .hero-section-testdrive {
            position: relative;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
        }
        
        .hero-section-testdrive * {
            color: white !important;
        }
        
        .hero-section-testdrive .text-warning,
        .hero-section-testdrive [style*="color: #ffc107"] {
            color: #ffc107 !important;
        }
        
        /* Ensure buttons are clickable */
        .btn {
            pointer-events: auto !important;
            cursor: pointer !important;
        }
        
        .card-img-wrapper .position-absolute {
            pointer-events: none;
        }
        
        /* Fix any z-index issues */
        .card-footer {
            position: relative;
            z-index: 5;
        }
    </style>
}
