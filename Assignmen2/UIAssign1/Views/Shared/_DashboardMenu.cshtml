@using BusinessLayer.Enums
@{
    var userRole = ViewBag.UserRole as UserRole?;
    var currentAction = ViewContext.RouteData.Values["action"]?.ToString();
    var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
}

<!-- TỔNG QUAN - Common cho tất cả roles -->
<div class="menu-section">
    <div class="menu-title">TỔNG QUAN</div>
    <a href="@Url.Action("Index", "Dashboard")" class="menu-item @(currentAction == "Index" ? "active" : "")">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
    </a>
    <a href="@Url.Action("Index", "Home")" class="menu-item">
        <i class="fas fa-home"></i>
        <span>Trang chủ</span>
    </a>
</div>

@if (userRole == UserRole.DealerStaff)
{
    <!-- MENU CHO DEALER STAFF - Gần như Dealer Manager nhưng loại bỏ 4 tính năng -->
    <div class="menu-section">
        <div class="menu-title">KINH DOANH</div>
        <a href="@Url.Action("Index", "Order")" class="menu-item @(currentController == "Order" ? "active" : "")">
            <i class="fas fa-file-invoice"></i>
            <span>Quản lý đơn hàng</span>
        </a>
        <a href="@Url.Action("CreateQuotation", "Order")" class="menu-item">
            <i class="fas fa-briefcase"></i>
            <span>Tạo báo giá mới</span>
        </a>
        <a href="@Url.Action("Index", "CustomerManagement")" class="menu-item @(currentController == "CustomerManagement" ? "active" : "")">
            <i class="fas fa-users"></i>
            <span>Quản lý khách hàng</span>
        </a>
        <a href="@Url.Action("Index", "TestDrive")" class="menu-item @(currentController == "TestDrive" ? "active" : "")">
            <i class="fas fa-calendar-check"></i>
            <span>Lịch lái thử</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">DỊCH VỤ KHÁCH HÀNG</div>
        <a href="@Url.Action("Index", "VehicleSearch")" class="menu-item @(currentController == "VehicleSearch" ? "active" : "")">
            <i class="fas fa-search"></i>
            <span>Tra cứu xe</span>
        </a>
      @*   <a href="#" class="menu-item">
            <i class="fas fa-comments"></i>
            <span>Phản hồi KH</span>
        </a> *@
    </div>
}
else if (userRole == UserRole.DealerManager)
{
    <!-- MENU CHO DEALER MANAGER -->
    <div class="menu-section">
        <div class="menu-title">QUẢN LÝ ĐẠI LÝ</div>
        <a href="@Url.Action("Index", "DealerReport")" class="menu-item @(currentController == "DealerReport" ? "active" : "")">
            <i class="fas fa-chart-line"></i>
            <span>Báo cáo doanh số</span>
        </a>
        <a href="@Url.Action("Index", "DealerDebtReport")" class="menu-item @(currentController == "DealerDebtReport" ? "active" : "")">
            <i class="fas fa-file-invoice-dollar"></i>
            <span>Báo cáo công nợ</span>
        </a>
        <a href="@Url.Action("Index", "UserManagement")" class="menu-item @(currentController == "UserManagement" ? "active" : "")">
            <i class="fas fa-users-cog"></i>
            <span>Quản lý nhân viên</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">KINH DOANH</div>
        <a href="@Url.Action("Index", "Order")" class="menu-item @(currentController == "Order" ? "active" : "")">
            <i class="fas fa-file-invoice"></i>
            <span>Quản lý đơn hàng</span>
        </a>
        <a href="@Url.Action("CreateQuotation", "Order")" class="menu-item">
            <i class="fas fa-briefcase"></i>
            <span>Tạo báo giá mới</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder")" class="menu-item @(currentController == "PurchaseOrder" ? "active" : "")">
            <i class="fas fa-box"></i>
            <span>Đặt xe từ hãng</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-tags"></i>
            <span>Quản lý khuyến mãi</span>
        </a>
       @*  <a href="#" class="menu-item">
            <i class="fas fa-shipping-fast"></i>
            <span>Theo dõi giao xe</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-credit-card"></i>
            <span>Quản lý thanh toán</span>
        </a> *@
    </div>
    
    <div class="menu-section">
        <div class="menu-title">KHÁCH HÀNG</div>
        <a href="#customersSubmenu" class="menu-item" data-bs-toggle="collapse" aria-expanded="false">
            <i class="fas fa-users"></i>
            <span>Quản lý khách hàng</span>
            <i class="fas fa-chevron-down ms-auto submenu-arrow"></i>
        </a>
        <div class="collapse submenu" id="customersSubmenu">
            <a asp-controller="CustomerManagement" asp-action="Index" class="submenu-item">
                <i class="fas fa-list"></i>
                <span>Danh sách khách hàng</span>
            </a>
            <a asp-controller="CustomerManagement" asp-action="Create" class="submenu-item">
                <i class="fas fa-user-plus"></i>
                <span>Thêm khách hàng</span>
            </a>
        </div>
        <a href="@Url.Action("Index", "TestDrive")" class="menu-item @(currentController == "TestDrive" ? "active" : "")">
            <i class="fas fa-calendar-alt"></i>
            <span>Lịch hẹn lái thử</span>
        </a>
        @* <a href="@Url.Action("Index", "CustomerFeedback")" class="menu-item @(currentController == "CustomerFeedback" ? "active" : "")">
            <i class="fas fa-comments"></i>
            <span>Phản hồi & khiếu nại</span>
        </a> *@
        <a href="@Url.Action("Index", "VehicleSearch")" class="menu-item @(currentController == "VehicleSearch" ? "active" : "")">
            <i class="fas fa-search"></i>
            <span>Tra cứu xe</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">HỆ THỐNG</div>
        <a href="#" class="menu-item">
            <i class="fas fa-cog"></i>
            <span>Cài đặt</span>
        </a>
    </div>
}
else if (userRole == UserRole.EVMStaff)
{
    <!-- MENU CHO EVM STAFF -->
    <div class="menu-section">
        <div class="menu-title">QUẢN LÝ SẢN PHẨM</div>
        <a href="@Url.Action("Index", "ProductManagement")" class="menu-item @(currentController == "ProductManagement" ? "active" : "")">
            <i class="fas fa-car"></i>
            <span>Quản lý sản phẩm</span>
        </a>
        <a href="@Url.Action("Create", "ProductManagement")" class="menu-item">
            <i class="fas fa-plus"></i>
            <span>Thêm sản phẩm mới</span>
        </a>
        <a href="@Url.Action("Index", "PricingManagement")" class="menu-item @(currentController == "PricingManagement" ? "active" : "")">
            <i class="fas fa-dollar-sign"></i>
            <span>Quản lý giá sỉ</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">ĐẶT HÀNG TỪ HÃNG</div>
        <a href="@Url.Action("Index", "PurchaseOrder")" class="menu-item @(currentController == "PurchaseOrder" ? "active" : "")">
            <i class="fas fa-shopping-cart"></i>
            <span>Tất cả đơn hàng</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder", new { status = 0 })" class="menu-item">
            <i class="fas fa-clock"></i>
            <span>Chờ duyệt</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder", new { status = 1 })" class="menu-item">
            <i class="fas fa-check-circle"></i>
            <span>Đã duyệt</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder", new { status = 3 })" class="menu-item">
            <i class="fas fa-truck"></i>
            <span>Đang vận chuyển</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">ĐẠI LÝ & ĐỐI TÁC</div>
        <a href="#" class="menu-item">
            <i class="fas fa-handshake"></i>
            <span>Danh sách đại lý</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-file-contract"></i>
            <span>Hợp đồng & chỉ tiêu</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-chart-area"></i>
            <span>Doanh số theo khu vực</span>
        </a>
    </div>

    <div class="menu-section">
        <div class="menu-title">BÁO CÁO</div>
        <a href="#" class="menu-item">
            <i class="fas fa-warehouse"></i>
            <span>Tồn kho & tiêu thụ</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-chart-line"></i>
            <span>Báo cáo doanh số</span>
        </a>
    </div>
}
else if (userRole == UserRole.Admin)
{
    <!-- MENU CHO ADMIN - Full quyền -->
    @* <div class="menu-section">
        <div class="menu-title">QUẢN TRỊ HỆ THỐNG</div>
        <a href="@Url.Action("Index", "UserManagement")" class="menu-item @(currentController == "UserManagement" ? "active" : "")">
            <i class="fas fa-users-cog"></i>
            <span>Quản lý tài khoản</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-shield-alt"></i>
            <span>Phân quyền</span>
        </a>
        <a href="#" class="menu-item">
            <i class="fas fa-history"></i>
            <span>Lịch sử hoạt động</span>
        </a>
    </div> *@
    
    <div class="menu-section">
        <div class="menu-title">QUẢN LÝ SẢN PHẨM</div>
        <a href="@Url.Action("Index", "Brand")" class="menu-item @(currentController == "Brand" ? "active" : "")">
            <i class="fas fa-copyright"></i>
            <span>Quản lý Thương hiệu</span>
        </a>
        <a href="@Url.Action("Index", "ProductManagement")" class="menu-item @(currentController == "ProductManagement" ? "active" : "")">
            <i class="fas fa-car"></i>
            <span>Quản lý sản phẩm</span>
        </a>
        <a href="@Url.Action("Index", "PricingManagement")" class="menu-item @(currentController == "PricingManagement" ? "active" : "")">
            <i class="fas fa-dollar-sign"></i>
            <span>Quản lý giá sỉ</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">ĐẶT HÀNG TỪ HÃNG</div>
        <a href="@Url.Action("Index", "PurchaseOrder")" class="menu-item @(currentController == "PurchaseOrder" ? "active" : "")">
            <i class="fas fa-shopping-cart"></i>
            <span>Tất cả đơn hàng</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder", new { status = 0 })" class="menu-item">
            <i class="fas fa-clock"></i>
            <span>Chờ duyệt</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder", new { status = 1 })" class="menu-item">
            <i class="fas fa-check-circle"></i>
            <span>Đã duyệt</span>
        </a>
        <a href="@Url.Action("Index", "PurchaseOrder", new { status = 3 })" class="menu-item">
            <i class="fas fa-truck"></i>
            <span>Đang vận chuyển</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">ĐẠI LÝ & ĐỐI TÁC</div>
        <a href="@Url.Action("Index", "Dealer")" class="menu-item @(currentController == "Dealer" ? "active" : "")">
            <i class="fas fa-building"></i>
            <span>Quản lý đại lý</span>
        </a>
        <a href="@Url.Action("Index", "UserManagement")" class="menu-item @(currentController == "UserManagement" ? "active" : "")">
            <i class="fas fa-users"></i>
            <span>Tài khoản đại lý</span>
        </a>
        <a href="@Url.Action("ContractManagement", "EVMDashboard")" class="menu-item">
            <i class="fas fa-file-contract"></i>
            <span>Hợp đồng & chỉ tiêu</span>
        </a>
    </div>
    
    <div class="menu-section">
        <div class="menu-title">BÁO CÁO & PHÂN TÍCH</div>
        <a href="@Url.Action("SalesReport", "EVMDashboard")" class="menu-item">
            <i class="fas fa-chart-area"></i>
            <span>Doanh số theo khu vực</span>
        </a>
        <a href="@Url.Action("SalesReportByStaff", "EVMDashboard")" class="menu-item">
            <i class="fas fa-user-tie"></i>
            <span>Doanh số theo nhân viên</span>
        </a>
        <a href="@Url.Action("CustomerDebtReport", "EVMDashboard")" class="menu-item">
            <i class="fas fa-money-bill-wave"></i>
            <span>Công nợ khách hàng</span>
        </a>
        <a href="@Url.Action("InventoryReport", "EVMDashboard")" class="menu-item">
            <i class="fas fa-warehouse"></i>
            <span>Tồn kho & tiêu thụ</span>
        </a>
        <a href="@Url.Action("DemandForecast", "EVMDashboard")" class="menu-item">
            <i class="fas fa-robot"></i>
            <span>AI dự đoán nhu cầu</span>
        </a>
    </div>
    
   
}
